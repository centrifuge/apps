name: "Deploy all apps"
on:
  # Allow this wofkflow as a universal "deployer" to 
  # call from other workflows.
  workflow_call:
    inputs:
      environment:
        required: true
        type: string

jobs:
  app:
    name: web-app
    uses: ./.github/workflows/centrifuge-app.yml
    secrets: inherit
    with:
      deploy_env: ${{ inputs.environment}}


  pinning:
    if: ${{ inputs.environment != 'ff-prod' }}
    name: pinning-api-gfunction
    uses:  ./.github/workflows/pinning-api.yml
    secrets: inherit
    with:
      deploy_env: ${{ inputs.environment }}


  onboarding:
    if: ${{ inputs.environment != 'ff-prod' }}
    name: onboarding-api-gfunction
    uses: ./.github/workflows/onboarding-api.yml
    secrets: inherit
    with:
      deploy_env: ${{ inputs.environment}}

  faucet:
    if: ${{ inputs.environment == 'demo'  || inputs.environment == 'development' }}
    name: faucet-api-gfunction
    uses: ./.github/workflows/faucet-api.yml
    secrets: inherit
    with:
      deploy_env: ${{ inputs.environment}}